<nav class="navbar navbar-expand-lg client-navbar">
  <div class="container-fluid">
    <a class="navbar-brand d-flex align-items-center" routerLink="/client">
      <fa-icon [icon]="faRocket" class="me-2 text-primary"></fa-icon>
      <span class="fw-bold">Workflow Designer</span>
    </a>
    
    <button
      class="navbar-toggler"
      type="button"
      (click)="toggleMenu()"
      [attr.aria-expanded]="isMenuOpen"
      aria-label="Toggle navigation"
    >
      <fa-icon [icon]="isMenuOpen ? faTimes : faBars"></fa-icon>
    </button>
    
    <div class="navbar-collapse" [class.show]="isMenuOpen" id="navbarNav">
      <!-- Search Bar -->
      <form class="navbar-search me-auto" (submit)="onSearch($event)">
        <div class="search-input-wrapper">
          <fa-icon [icon]="faSearch" class="search-icon"></fa-icon>
          <input
            type="text"
            class="form-control search-input"
            placeholder="Search users..."
            [(ngModel)]="searchQuery"
            name="searchQuery"
          />
        </div>
      </form>
      
      <!-- Right Side: Notifications and User Menu -->
      <div class="navbar-right d-flex align-items-center gap-3">
        <!-- Notifications -->
        <button class="btn btn-icon" type="button" title="Notifications">
          <fa-icon [icon]="faBell"></fa-icon>
          <span class="notification-badge">2</span>
        </button>
        
        <!-- User Dropdown -->
        <div class="user-dropdown" clickOutside (clickOutside)="closeUserDropdown()">
          <button
            class="btn btn-user"
            type="button"
            (click)="toggleUserDropdown()"
            [attr.aria-expanded]="isUserDropdownOpen"
          >
            <div class="user-avatar">
              @if (currentUser) {
                <span class="user-initials">{{ getUserInitials() }}</span>
              } @else {
                <fa-icon [icon]="faUser"></fa-icon>
              }
            </div>
            <span class="user-name d-none d-md-inline">
              @if (currentUser) {
                {{ getUserDisplayName() }}
              } @else {
                Admin
              }
            </span>
            <fa-icon [icon]="faChevronDown" class="dropdown-icon"></fa-icon>
          </button>
          
          @if (isUserDropdownOpen && currentUser) {
            <div class="dropdown-menu show">
              <div class="dropdown-header">
                <div class="user-info">
                  <div class="user-name">{{ getUserDisplayName() }}</div>
                  <div class="user-email">{{ currentUser.email || currentUser.username }}</div>
                  <div class="user-role badge bg-info mt-2">CLIENT_ADMIN</div>
                  @if (currentUser.clientName) {
                    <div class="client-name text-muted small mt-1">{{ currentUser.clientName }}</div>
                  }
                </div>
              </div>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" routerLink="/client" (click)="closeUserDropdown()">
                <fa-icon [icon]="faUser" class="me-2"></fa-icon>
                Dashboard
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item text-danger" (click)="logout()">
                <fa-icon [icon]="faSignOutAlt" class="me-2"></fa-icon>
                Logout
              </a>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</nav>
