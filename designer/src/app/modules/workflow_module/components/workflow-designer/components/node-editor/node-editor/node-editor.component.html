@if (isOpen()) {
  <div class="node-editor position-fixed top-0 start-0 w-100 h-100 bg-white d-flex" style="z-index: 1050;">
    <button
      type="button"
      class="btn btn-sm btn-outline-secondary position-absolute top-0 end-0 m-3"
      (click)="closeEditor()"
      title="Close Node Editor"
      style="z-index: 1051;"
    >
      <fa-icon [icon]="faTimes"></fa-icon>
    </button>

    <div class="flex-grow-1 d-flex position-relative" style="min-width: 0; max-width: 100%; overflow: hidden;">
      <!-- Previous Node Response -->
      <div 
        class="node-editor-panel border-end p-3 overflow-auto"
        [style.width.%]="leftColumnWidth()"
        [style.flex-basis.%]="leftColumnWidth()"
        [style.max-width.%]="leftColumnWidth()"
      >
        <app-card title="Previous Node Response">
          @if (getPreviousNodeResult(); as prevResult) {
            <app-json-viewer [data]="prevResult.outputs" title="Previous Node Outputs"></app-json-viewer>
          } @else {
            <p class="text-muted mb-0 small">No previous node connected</p>
          }
        </app-card>
      </div>

      <!-- Resize Handle 1 (between left and middle) -->
      <div 
        class="resize-handle"
        (mousedown)="onResizeStart('left', $event)"
        title="Drag to resize columns"
      ></div>

      <!-- Configure Node Panel -->
      <div 
        class="node-editor-panel border-end p-3 overflow-auto"
        [style.width.%]="middleColumnWidth()"
        [style.flex-basis.%]="middleColumnWidth()"
        [style.max-width.%]="middleColumnWidth()"
      >
        <app-properties-panel></app-properties-panel>
      </div>

      <!-- Resize Handle 2 (between middle and right) -->
      <div 
        class="resize-handle"
        (mousedown)="onResizeStart('right', $event)"
        title="Drag to resize columns"
      ></div>

      <!-- Current Node Response -->
      <div 
        class="node-editor-panel p-3 overflow-auto"
        [style.width.%]="rightColumnWidth()"
        [style.flex-basis.%]="rightColumnWidth()"
        [style.max-width.%]="rightColumnWidth()"
      >
        <app-card title="Current Node Response">
          @if (selectedNode(); as node) {
            <div class="mb-3">
              <strong class="small">{{ node.data.label }}</strong>
              <span class="badge bg-secondary ms-2" style="font-size: 0.625rem;">{{ node.type }}</span>
            </div>
            @if (getCurrentNodeResult(); as currentResult) {
              <div>
                <div class="mb-2">
                  <span class="badge" 
                        [class.bg-success]="currentResult.status === 'success'" 
                        [class.bg-danger]="currentResult.status === 'failed'"
                        [class.bg-warning]="currentResult.status === 'skipped'"
                        style="font-size: 0.625rem;">
                    {{ currentResult.status }}
                  </span>
                </div>
                <app-json-viewer [data]="currentResult.outputs" title="Current Node Outputs"></app-json-viewer>
                @if (currentResult.error) {
                  <div class="alert alert-danger mt-3 small" style="font-size: 0.6875rem; padding: 0.5rem;">
                    <strong>Error:</strong> {{ currentResult.error }}
                  </div>
                }
              </div>
            } @else {
              <p class="text-muted mb-0 small">
                No execution result available. Run the workflow to see this node's output.
              </p>
            }
          }
        </app-card>
      </div>
    </div>
  </div>
}
